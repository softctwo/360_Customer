<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据分析仪表板 - 客户画像系统</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- 头部 -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-title">
                    <span class="header-icon">📊</span>
                    <h1>票据业务客户画像系统</h1>
                </div>
                <nav class="header-nav">
                    <a href="index.html" class="nav-link">客户画像</a>
                    <a href="dashboard.html" class="nav-link active">数据分析</a>
                    <a href="risk-warning.html" class="nav-link">风险预警</a>
                    <a href="marketing-strategy.html" class="nav-link">营销策略</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- 主内容 -->
    <main class="main-content dashboard-content">
        <div class="container">
            <!-- 页面标题 -->
            <div class="page-header">
                <div>
                    <h2 class="page-title">数据分析仪表板</h2>
                    <p class="page-subtitle">实时监控票据业务关键指标</p>
                </div>
                <div class="header-actions">
                    <select class="time-range-select" id="timeRange">
                        <option value="today">今日</option>
                        <option value="week">本周</option>
                        <option value="month" selected>本月</option>
                        <option value="quarter">本季度</option>
                        <option value="year">本年</option>
                    </select>
                    <button class="btn btn-primary" onclick="refreshData()">🔄 刷新数据</button>
                    <button class="btn btn-success" onclick="exportReport()">📥 导出报告</button>
                </div>
            </div>

            <!-- KPI 指标卡片 -->
            <div class="kpi-grid">
                <div class="kpi-card kpi-primary">
                    <div class="kpi-icon">💰</div>
                    <div class="kpi-content">
                        <div class="kpi-label">总交易金额</div>
                        <div class="kpi-value" id="kpiTotalAmount">12,370亿</div>
                        <div class="kpi-trend">
                            <span class="trend-up">↑ 15.3%</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>

                <div class="kpi-card kpi-success">
                    <div class="kpi-icon">📈</div>
                    <div class="kpi-content">
                        <div class="kpi-label">交易笔数</div>
                        <div class="kpi-value" id="kpiTotalCount">23,450</div>
                        <div class="kpi-trend">
                            <span class="trend-up">↑ 8.7%</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>

                <div class="kpi-card kpi-warning">
                    <div class="kpi-icon">👥</div>
                    <div class="kpi-content">
                        <div class="kpi-label">活跃客户数</div>
                        <div class="kpi-value" id="kpiActiveCustomers">89</div>
                        <div class="kpi-trend">
                            <span class="trend-up">↑ 12</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>

                <div class="kpi-card kpi-danger">
                    <div class="kpi-icon">⚠️</div>
                    <div class="kpi-content">
                        <div class="kpi-label">风险预警</div>
                        <div class="kpi-value" id="kpiRiskAlerts">13</div>
                        <div class="kpi-trend">
                            <span class="trend-down">↓ 3</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>

                <div class="kpi-card kpi-info">
                    <div class="kpi-icon">💎</div>
                    <div class="kpi-content">
                        <div class="kpi-label">强势客户占比</div>
                        <div class="kpi-value" id="kpiPremiumRate">28.3%</div>
                        <div class="kpi-trend">
                            <span class="trend-up">↑ 2.1%</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>

                <div class="kpi-card kpi-purple">
                    <div class="kpi-icon">🎯</div>
                    <div class="kpi-content">
                        <div class="kpi-label">客户满意度</div>
                        <div class="kpi-value" id="kpiSatisfaction">94.5%</div>
                        <div class="kpi-trend">
                            <span class="trend-up">↑ 1.2%</span>
                            <span class="trend-label">较上月</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 图表区域 - 第一行 -->
            <div class="chart-row">
                <div class="chart-card chart-large">
                    <div class="chart-header">
                        <h3 class="chart-title">📊 月度交易趋势分析</h3>
                        <div class="chart-actions">
                            <button class="chart-action-btn active" onclick="switchChartType('line')">折线图</button>
                            <button class="chart-action-btn" onclick="switchChartType('bar')">柱状图</button>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="monthlyTrendChart"></canvas>
                    </div>
                </div>

                <div class="chart-card chart-medium">
                    <div class="chart-header">
                        <h3 class="chart-title">🏭 行业分布</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="industryPieChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 图表区域 - 第二行 -->
            <div class="chart-row">
                <div class="chart-card chart-medium">
                    <div class="chart-header">
                        <h3 class="chart-title">📍 地区分布热力图</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="regionBarChart"></canvas>
                    </div>
                </div>

                <div class="chart-card chart-medium">
                    <div class="chart-header">
                        <h3 class="chart-title">⚠️ 风险等级分布</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="riskDoughnutChart"></canvas>
                    </div>
                </div>

                <div class="chart-card chart-medium">
                    <div class="chart-header">
                        <h3 class="chart-title">👥 客户类型分布</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="customerTypePieChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 图表区域 - 第三行 -->
            <div class="chart-row">
                <div class="chart-card chart-large">
                    <div class="chart-header">
                        <h3 class="chart-title">🎫 票据种类交易对比</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="ticketTypeCompareChart"></canvas>
                    </div>
                </div>

                <div class="chart-card chart-medium">
                    <div class="chart-header">
                        <h3 class="chart-title">📈 客户增长趋势</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="customerGrowthChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 图表区域 - 第四行 -->
            <div class="chart-row">
                <div class="chart-card chart-full">
                    <div class="chart-header">
                        <h3 class="chart-title">🎯 客户价值矩阵（散点图）</h3>
                        <p class="chart-subtitle">横轴：年交易额 | 纵轴：交易频率</p>
                    </div>
                    <div class="chart-body chart-large-height">
                        <canvas id="customerValueScatterChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 图表区域 - 第五行：热力图 -->
            <div class="chart-row">
                <div class="chart-card chart-full">
                    <div class="chart-header">
                        <h3 class="chart-title">🔥 全行贴现量行业分类热度图</h3>
                        <p class="chart-subtitle">纵轴：行业分类 | 横轴：月份 | 颜色深度：贴现量</p>
                        <div class="chart-actions">
                            <select class="heatmap-metric-select" id="heatmapMetric" onchange="updateHeatmapMetric()">
                                <option value="amount">按金额</option>
                                <option value="count">按笔数</option>
                                <option value="growth">按增长率</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-body" style="height: auto; padding: 20px 0;">
                        <div id="industryHeatmap" class="heatmap-container"></div>
                        <div class="heatmap-legend">
                            <span class="legend-label">低</span>
                            <div class="legend-gradient"></div>
                            <span class="legend-label">高</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 行业综合分析区域 -->
            <div class="industry-analysis-section">
                <div class="section-header">
                    <div>
                        <h3 class="section-title">🏭 行业综合分析</h3>
                        <p class="section-subtitle">按行业维度分析客户数据，支持营销推广和风险把控</p>
                    </div>
                    <div class="section-actions">
                        <select class="industry-selector" id="industrySelector" onchange="updateIndustryAnalysis()">
                            <option value="全部">全部行业</option>
                            <option value="能源化工">能源化工</option>
                            <option value="电子信息">电子信息</option>
                            <option value="汽车制造">汽车制造</option>
                            <option value="建筑业">建筑业</option>
                            <option value="批发零售">批发零售</option>
                            <option value="金融业">金融业</option>
                            <option value="食品饮料">食品饮料</option>
                            <option value="交通运输">交通运输</option>
                        </select>
                    </div>
                </div>

                <!-- 行业概览卡片 -->
                <div class="industry-overview-cards">
                    <div class="industry-stat-card">
                        <div class="stat-icon">👥</div>
                        <div class="stat-content">
                            <div class="stat-label">行业客户数</div>
                            <div class="stat-value" id="industryCustomerCount">106</div>
                        </div>
                    </div>
                    <div class="industry-stat-card">
                        <div class="stat-icon">💰</div>
                        <div class="stat-content">
                            <div class="stat-label">总交易额</div>
                            <div class="stat-value" id="industryTotalAmount">1.24万亿</div>
                        </div>
                    </div>
                    <div class="industry-stat-card">
                        <div class="stat-icon">📊</div>
                        <div class="stat-content">
                            <div class="stat-label">总交易笔数</div>
                            <div class="stat-value" id="industryTotalCount">23,450</div>
                        </div>
                    </div>
                    <div class="industry-stat-card">
                        <div class="stat-icon">⚠️</div>
                        <div class="stat-content">
                            <div class="stat-label">平均风险等级</div>
                            <div class="stat-value" id="industryAvgRisk">低风险</div>
                        </div>
                    </div>
                    <div class="industry-stat-card">
                        <div class="stat-icon">⭐</div>
                        <div class="stat-content">
                            <div class="stat-label">强势客户占比</div>
                            <div class="stat-value" id="industryPremiumRate">28.3%</div>
                        </div>
                    </div>
                </div>

                <!-- 行业客户详细排名表格 -->
                <div class="industry-table-container">
                    <div class="industry-table-header">
                        <h4 class="table-title">行业客户排名</h4>
                        <div class="table-actions">
                            <button class="sort-btn active" onclick="sortIndustryTable('amount')">
                                <span class="sort-icon">💰</span> 按交易额
                            </button>
                            <button class="sort-btn" onclick="sortIndustryTable('count')">
                                <span class="sort-icon">📊</span> 按笔数
                            </button>
                            <button class="sort-btn" onclick="sortIndustryTable('risk')">
                                <span class="sort-icon">⚠️</span> 按风险
                            </button>
                            <button class="sort-btn" onclick="sortIndustryTable('credit')">
                                <span class="sort-icon">⭐</span> 按信用
                            </button>
                        </div>
                    </div>
                    <div class="industry-table-wrapper">
                        <table class="industry-table" id="industryTable">
                            <thead>
                                <tr>
                                    <th class="col-rank">排名</th>
                                    <th class="col-name">客户名称</th>
                                    <th class="col-type">客户类型</th>
                                    <th class="col-amount">年交易额</th>
                                    <th class="col-count">年交易笔数</th>
                                    <th class="col-credit">信用评级</th>
                                    <th class="col-risk">风险等级</th>
                                    <th class="col-rate">强势等级</th>
                                    <th class="col-growth">增长趋势</th>
                                    <th class="col-action">操作</th>
                                </tr>
                            </thead>
                            <tbody id="industryTableBody">
                                <!-- 动态生成 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 行业风险分布 -->
                <div class="industry-risk-distribution">
                    <h4 class="distribution-title">行业风险分布</h4>
                    <div class="risk-bars">
                        <div class="risk-bar-item">
                            <div class="risk-bar-label">
                                <span class="risk-badge risk-low">低风险</span>
                                <span class="risk-count" id="riskLowCount">0</span>
                            </div>
                            <div class="risk-bar-track">
                                <div class="risk-bar-fill risk-low-fill" id="riskLowBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="risk-bar-item">
                            <div class="risk-bar-label">
                                <span class="risk-badge risk-medium">中风险</span>
                                <span class="risk-count" id="riskMediumCount">0</span>
                            </div>
                            <div class="risk-bar-track">
                                <div class="risk-bar-fill risk-medium-fill" id="riskMediumBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="risk-bar-item">
                            <div class="risk-bar-label">
                                <span class="risk-badge risk-high">中高风险</span>
                                <span class="risk-count" id="riskHighMediumCount">0</span>
                            </div>
                            <div class="risk-bar-track">
                                <div class="risk-bar-fill risk-high-medium-fill" id="riskHighMediumBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="risk-bar-item">
                            <div class="risk-bar-label">
                                <span class="risk-badge risk-critical">高风险</span>
                                <span class="risk-count" id="riskCriticalCount">0</span>
                            </div>
                            <div class="risk-bar-track">
                                <div class="risk-bar-fill risk-critical-fill" id="riskCriticalBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 数据表格区域 -->
            <div class="data-table-section">
                <div class="section-header">
                    <h3 class="section-title">📋 TOP 10 客户排行榜</h3>
                    <div class="section-actions">
                        <button class="btn btn-secondary" onclick="sortBy('amount')">按金额排序</button>
                        <button class="btn btn-secondary" onclick="sortBy('count')">按笔数排序</button>
                        <button class="btn btn-secondary" onclick="sortBy('growth')">按增长率排序</button>
                    </div>
                </div>
                <div class="ranking-grid">
                    <div class="ranking-item rank-1">
                        <div class="rank-badge">🥇</div>
                        <div class="rank-info">
                            <div class="rank-name">中国建设银行股份有限公司</div>
                            <div class="rank-meta">金融业 · 北京</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-value">2,560亿</div>
                            <div class="rank-label">年交易额</div>
                        </div>
                    </div>

                    <div class="ranking-item rank-2">
                        <div class="rank-badge">🥈</div>
                        <div class="rank-info">
                            <div class="rank-name">中国石油天然气集团有限公司</div>
                            <div class="rank-meta">能源化工 · 北京</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-value">1,580亿</div>
                            <div class="rank-label">年交易额</div>
                        </div>
                    </div>

                    <div class="ranking-item rank-3">
                        <div class="rank-badge">🥉</div>
                        <div class="rank-info">
                            <div class="rank-name">华为技术有限公司</div>
                            <div class="rank-meta">电子信息 · 广东</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-value">895亿</div>
                            <div class="rank-label">年交易额</div>
                        </div>
                    </div>

                    <div class="ranking-item">
                        <div class="rank-badge">4</div>
                        <div class="rank-info">
                            <div class="rank-name">比亚迪股份有限公司</div>
                            <div class="rank-meta">汽车制造 · 广东</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-value">456亿</div>
                            <div class="rank-label">年交易额</div>
                        </div>
                    </div>

                    <div class="ranking-item">
                        <div class="rank-badge">5</div>
                        <div class="rank-info">
                            <div class="rank-name">上海建工集团股份有限公司</div>
                            <div class="rank-meta">建筑业 · 上海</div>
                        </div>
                        <div class="rank-stats">
                            <div class="rank-value">320亿</div>
                            <div class="rank-label">年交易额</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 实时监控区域 -->
            <div class="monitor-section">
                <div class="section-header">
                    <h3 class="section-title">⚡ 实时业务监控</h3>
                    <div class="monitor-status">
                        <span class="status-indicator status-active"></span>
                        <span>实时更新中</span>
                    </div>
                </div>
                <div class="monitor-grid">
                    <div class="monitor-card">
                        <div class="monitor-header">
                            <span class="monitor-icon">📝</span>
                            <span class="monitor-title">今日新增票据</span>
                        </div>
                        <div class="monitor-value">1,234 笔</div>
                        <div class="monitor-chart">
                            <canvas id="todayTicketsChart"></canvas>
                        </div>
                    </div>

                    <div class="monitor-card">
                        <div class="monitor-header">
                            <span class="monitor-icon">💳</span>
                            <span class="monitor-title">贴现业务量</span>
                        </div>
                        <div class="monitor-value">567 笔</div>
                        <div class="monitor-chart">
                            <canvas id="discountChart"></canvas>
                        </div>
                    </div>

                    <div class="monitor-card">
                        <div class="monitor-header">
                            <span class="monitor-icon">⏰</span>
                            <span class="monitor-title">平均处理时长</span>
                        </div>
                        <div class="monitor-value">2.3 小时</div>
                        <div class="monitor-chart">
                            <canvas id="processingTimeChart"></canvas>
                        </div>
                    </div>

                    <div class="monitor-card">
                        <div class="monitor-header">
                            <span class="monitor-icon">✅</span>
                            <span class="monitor-title">业务成功率</span>
                        </div>
                        <div class="monitor-value">98.7%</div>
                        <div class="monitor-chart">
                            <canvas id="successRateChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 引入数据和脚本 -->
    <script src="js/data-mock.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>
